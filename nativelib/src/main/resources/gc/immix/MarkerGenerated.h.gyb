#ifndef IMMIX_MARKER_GENERATED_H
#define IMMIX_MARKER_GENERATED_H

#include "headers/ObjectHeader.h"
#include "datastructures/Stack.h"
#include "Heap.h"
#include "Marker.h"

INLINE void markerGenerated_mark(Heap* heap, Stack* stack, ObjectHeader* object, ubyte_t *ptrByte) {
    int offset = 0;
    switchLabel:
    switch (*ptrByte) {
% for b in range(255):
        case ${b}:
    % if (b < 128):
        % for i in range(6):
            % if(b >> (7-(i+2)) & 1 == 1):
                marker_markField(heap, stack, object, offset + ${i});
            %end
        %end
    %end
    % if (b < 64):
        break;
    %elif (b < 128):
            // update
            ptrByte += 1;
            offset += 6;
            goto switchLabel;
    %end
%end
        default:
            // handle arrays
            marker_markObjectArray(heap, stack, object);
            break;
    }
}


#endif //IMMIX_MARKER_GENERATED_H